<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Go Travel ‚úàÔ∏è</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    .input {
      @apply w-full px-3 py-2 rounded-xl border border-gray-300 shadow-sm text-sm;
    }
    .btn {
      @apply bg-indigo-500 text-white px-4 py-2 rounded-xl text-sm font-semibold hover:bg-indigo-600;
    }
    .fade {
      transition: all 0.3s ease-in-out;
    }
  </style>
</head>
<body class="bg-gradient-to-r from-sky-100 to-indigo-100 min-h-screen p-4">
  <div class="max-w-2xl mx-auto">
    <div class="flex justify-between items-center">
      <h1 class="text-3xl font-bold mb-4">Go Travel ‚úàÔ∏è</h1>
      <select id="langSwitch" class="text-sm px-2 py-1 rounded">
        <option value="ru">RU</option>
        <option value="en">EN</option>
      </select>
    </div>

    <!-- Tabs -->
    <div class="flex justify-center mb-4 gap-2">
      <button class="tab-btn bg-white px-4 py-2 rounded-xl shadow text-sm font-medium" onclick="showTab('flights')">‚úàÔ∏è <span data-ru="–ê–≤–∏–∞–±–∏–ª–µ—Ç—ã" data-en="Flights">–ê–≤–∏–∞–±–∏–ª–µ—Ç—ã</span></button>
      <button class="tab-btn bg-white px-4 py-2 rounded-xl shadow text-sm font-medium" onclick="showTab('hotels')">üè® <span data-ru="–û—Ç–µ–ª–∏" data-en="Hotels">–û—Ç–µ–ª–∏</span></button>
      <button class="tab-btn bg-white px-4 py-2 rounded-xl shadow text-sm font-medium" onclick="showTab('sights')">üåç <span data-ru="–ú–µ—Å—Ç–∞" data-en="Places">–ú–µ—Å—Ç–∞</span></button>
    </div>

    <!-- Flights -->
    <div id="flights" class="tab fade">
      <form id="search-form" class="bg-white p-4 rounded-xl shadow mb-4 space-y-2">
        <input type="text" name="from" placeholder="–û—Ç–∫—É–¥–∞" class="input" required />
        <input type="text" name="to" placeholder="–ö—É–¥–∞" class="input" required />
        <input type="date" name="date" class="input" required />
        <div class="flex gap-2">
          <select name="sortPrice" class="input">
            <option value="none">–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Ü–µ–Ω–µ</option>
            <option value="asc">–ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
            <option value="desc">–ü–æ —É–±—ã–≤–∞–Ω–∏—é</option>
          </select>
          <input type="number" name="maxDuration" placeholder="–ú–∞–∫—Å. –¥–ª–∏—Ç. (–º–∏–Ω)" class="input" />
        </div>
        <label class="inline-flex items-center gap-2 text-sm">
          <input type="checkbox" name="directOnly" /> –¢–æ–ª—å–∫–æ –ø—Ä—è–º—ã–µ
        </label>
        <button type="submit" class="btn w-full">–ù–∞–π—Ç–∏ —Ä–µ–π—Å—ã</button>
      </form>
      <div id="flights-container" class="space-y-4"></div>
    </div>

    <!-- Hotels -->
    <div id="hotels" class="tab hidden fade">
      <form id="hotelForm" class="bg-white p-4 rounded-xl shadow mb-4 space-y-2">
        <input type="text" placeholder="–ì–æ—Ä–æ–¥" id="hotelCity" class="input" required />
        <input type="date" id="checkIn" class="input" />
        <input type="date" id="checkOut" class="input" />
        <input type="number" placeholder="–ì–æ—Å—Ç–µ–π" id="guests" class="input" min="1" />
        <input type="number" placeholder="–¶–µ–Ω–∞ –¥–æ ($)" id="maxHotelPrice" class="input" />
        <input type="number" placeholder="–ú–∏–Ω. —Ä–µ–π—Ç–∏–Ω–≥ (0-10)" id="minRating" class="input" step="0.1" />
        <button type="submit" class="btn w-full">–ù–∞–π—Ç–∏ –æ—Ç–µ–ª—å</button>
      </form>
      <div id="hotelsResult"></div>
    </div>

    <!-- Sights -->
    <div id="sights" class="tab hidden fade">
      <p class="text-center text-gray-500">üåç –î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ—è–≤—è—Ç—Å—è —Å–∫–æ—Ä–æ</p>
    </div>
  </div>

  <script>
    const userId = window.Telegram?.WebApp?.initDataUnsafe?.user?.id;
    console.log("User ID:", userId);

    const flightsData = [
      { airline: 'Ryanair', from: 'Kyiv', to: 'Lisbon', price: 140, duration: 300, transfers: 1 },
      { airline: 'WizzAir', from: 'Lviv', to: 'Barcelona', price: 120, duration: 270, transfers: 0 },
      { airline: 'SkyUp', from: 'Kyiv', to: 'Paris', price: 200, duration: 240, transfers: 1 },
    ];

    function renderFlights(data) {
      const container = document.getElementById('flights-container');
      container.innerHTML = `<div class='text-sm text-gray-600 mb-2'>–ù–∞–π–¥–µ–Ω–æ: ${data.length}</div>`;
      if (!data.length) {
        container.innerHTML = '<p class="text-center text-gray-500">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</p>';
        return;
      }
      data.forEach((f) => {
        container.innerHTML += `
          <div class="bg-white p-4 rounded-xl shadow">
            <div class="flex justify-between">
              <strong>${f.airline}</strong>
              <span class="text-indigo-500">$${f.price}</span>
            </div>
            <div class="text-sm">${f.from} ‚úàÔ∏è ${f.to}</div>
            <div class="text-xs text-gray-500">${Math.floor(f.duration/60)}—á ‚Ä¢ –ü–µ—Ä–µ—Å–∞–¥–∫–∏: ${f.transfers}</div>
          </div>
        `;
      });
    }

    document.getElementById("search-form").addEventListener("submit", (e) => {
      e.preventDefault();
      const form = e.target;
      const from = form.from.value.toLowerCase();
      const to = form.to.value.toLowerCase();
      const maxDuration = parseInt(form.maxDuration.value);
      const directOnly = form.directOnly.checked;
      const sort = form.sortPrice.value;

      let results = flightsData.filter(f => f.from.toLowerCase().includes(from) && f.to.toLowerCase().includes(to));
      if (directOnly) results = results.filter(f => f.transfers === 0);
      if (!isNaN(maxDuration)) results = results.filter(f => f.duration <= maxDuration);
      if (sort === 'asc') results.sort((a,b) => a.price - b.price);
      if (sort === 'desc') results.sort((a,b) => b.price - a.price);

      renderFlights(results);
    });

    const hotelMock = [
      { name: "Hotel A", city: "Kyiv", price: 90, rating: 8.5 },
      { name: "Budget B", city: "Kyiv", price: 60, rating: 7.9 },
      { name: "Premium C", city: "Kyiv", price: 150, rating: 9.2 },
    ];

    document.getElementById("hotelForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const city = document.getElementById("hotelCity").value.toLowerCase();
      const maxPrice = parseFloat(document.getElementById("maxHotelPrice").value);
      const minRating = parseFloat(document.getElementById("minRating").value);
      let results = hotelMock.filter(h => h.city.toLowerCase().includes(city));
      if (!isNaN(maxPrice)) results = results.filter(h => h.price <= maxPrice);
      if (!isNaN(minRating)) results = results.filter(h => h.rating >= minRating);

      const block = document.getElementById("hotelsResult");
      block.innerHTML = `<div class='text-sm text-gray-600 mb-2'>–ù–∞–π–¥–µ–Ω–æ: ${results.length}</div>`;
      results.forEach(h => {
        block.innerHTML += `
          <div class="bg-white p-4 rounded-xl shadow mb-2">
            <strong>${h.name}</strong> (${h.city})<br>
            –¶–µ–Ω–∞: $${h.price} / –Ω–æ—á—å<br>
            –†–µ–π—Ç–∏–Ω–≥: ${h.rating}
          </div>
        `;
      });
    });

    function showTab(id) {
      document.querySelectorAll('.tab').forEach(t => t.classList.add('hidden'));
      document.getElementById(id).classList.remove('hidden');
    }

    document.getElementById("langSwitch").addEventListener("change", (e) => {
      const lang = e.target.value;
      document.querySelectorAll('[data-ru]').forEach(el => {
        el.textContent = el.getAttribute(`data-${lang}`);
      });
    });
  </script>
</body>
</html>
